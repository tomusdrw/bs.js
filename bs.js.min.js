if(!Function.prototype.bind)Function.prototype.bind=function(a){var b=[].slice,c=b.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e?this:a||{},c.concat(b.call(arguments)))};e.prototype=d.prototype;f.prototype=new e;return f};bs={};bs.util={};bs.$=function(a){if(typeof a==="string")a=document.getElementById(a);return a=a?bs.DOMObject.createNew(a):null};bs.$._cache={};bs.Object=function(){};
bs.Object.prototype={inherit:function(a){return this.merge(a.prototype)},merge:function(a){for(var b in a)if(this.hasOwnProperty(b)){console.log("[bs.Object.merge] Attribute exists: "+b+". Obj: ");console.log(this)}else this[b]=a[b];return this},isUndefined:function(a){return typeof a==="undefined"}};bs.Object.createNew=function(a){return new this(a)};
bs.Object.create=function(a){var b,c=this.createNew();for(b in a)if(c.hasOwnProperty(b)){console.log("[bs.Object.create] Attribute exsits: "+b+". Obj: ");console.log(a)}else c[b]=a[b];return c};
bs.opt=bs.Object.create({_fastInnerHTML:function(a,b){if(a.parentNode){var c=a.cloneNode(false);c.innerHTML=b;a.parentNode.replaceChild(c,a);return c}else{a.innerHTML=b;return a}},posFloor:function(a){return~~a},floor:function(a){if(a>=0)return~~a;return Math.floor(a)},number:function(a){return+a},mix:function(a,b){var c,d;c={};if(a&&a.prototype)c.prototype=a.prototype;for(d in a)if(a.hasOwnProperty(d))c[d]=a[d];for(d in b)c.hasOwnProperty(d)||(c[d]=b[d]);return c}});
bs.DOMObject=function(a){var b,c;this[0]=a;b=0;for(c=this.__constructors.length;b<c;b+=1)this.__constructors[b](this,a)};
bs.DOMObject.prototype=bs.Object.create({bsdom:true,__constructors:[],addClass:function(a){var b=this[0].className;if(b.indexOf(a)===-1)this[0].className=b+(b.length?" ":"")+a;return this},hasClass:function(a){return(" "+this[0].className+" ").indexOf(" "+a+" ")!==-1},removeClass:function(a){var b=" "+this[0].className+" ",c=b.indexOf(" "+a+" ");if(c!==-1)this[0].className=b.substr(1,c-1)+b.substring((c===0)+1+c+a.length,b.length-1);return this},getWidth:function(a){a=a||window.getComputedStyle(this[0],
null);return bs.opt.number(this[0].offsetWidth-a.paddingLeft.replace("px","")-a.paddingRight.replace("px","")-a.borderLeftWidth.replace("px","")-a.borderRightWidth.replace("px",""))},getHeight:function(a){a=a||window.getComputedStyle(this[0],null);return bs.opt.number(this[0].offsetHeight-a.paddingTop.replace("px","")-a.paddingBottom.replace("px","")-a.borderTopWidth.replace("px","")-a.borderBottomWidth.replace("px",""))},html:function(a){if(a!==undefined){if(a.bsdom)a=a[0];this[0]=bs.opt._fastInnerHTML(this[0],
a);return this}return this[0].innerHTML},append:function(a){if(a.nodeType)this[0].appendChild(a);else a.bsdom?this[0].appendChild(a[0]):bs.opt._fastInnerHTML(this[0],this[0].innerHTML+a);return this},prepend:function(a){if(a.bsdom)a=a[0];if(a.nodeType){this[0].insertBefore(a,this[0].firstChild);return this}bs.opt._fastInnerHTML(this[0],a+this[0].innerHTML);return this},addEventListener:function(a,b,c){try{return this[0].addEventListener(a,b,c||false)}catch(d){console.log(d)}},hide:function(){this[1]||
(this[1]=this[0].cloneNode(true));this[0].style.display="none";return this},show:function(){this[0].style.display=this[1]?this[1].style.display:"block";return this},destroy:function(){this[0].parentNode&&this[0].parentNode.removeChild(this[0]);this[0]=null;return this}});bs.DOMObject.createNew=bs.Object.createNew;
bs.DOMObject.prototype.__constructors.push(function(a){a.__animationStep=a.__animationStep.bind(a);a.__animationStepScale=a.__animationStepScale.bind(a);a._showEnd=a._showEnd.bind(a);a._hideShowStart=a._hideShowStart.bind(a);a._hideEnd=a._hideEnd.bind(a);a._destroyEnd=a._destroyEnd.bind(a);a._fadeOutStart=a._fadeOutStart.bind(a);a._fadeInStart=a._fadeInStart.bind(a)});
bs.DOMObject.prototype=bs.opt.mix({__static:bs.DOMObject,__animationInterval:17,__defaultTime:500,__propsUnits:{width:"px",height:"px",top:"px",left:"px",paddingTop:"px",paddingLeft:"px",paddingRight:"px",paddingBottom:"px",marginTop:"px",marginBottom:"px",marginRight:"px",marginLeft:"px",borderTopWidth:"px",borderBottomWidth:"px",borderLeftWidth:"px",borderRightWidth:"px"},__propsDefaultVals:{opacity:1,top:0,left:0,scaleX:1,scaleY:1,scale:1},_css_transform_preffix:function(){var a=document.createElement("div");
a.style.cssText="transform: scale(2)";if(a.style.transform){console.log("Transformations detected.");return""}a.style.cssText="-webkit-transform: scale(2); -moz-transform: scale(2); -o-transform: scale(2); ";if(a.style["-webkit-transform"]){console.log("Webkit transformations detected.");return"-webkit-"}if(a.style["-moz-transform"]){console.log("Moz transformations detected.");return"-moz-"}if(a.style["-o-transform"]){console.log("Opera transformations detected.");return"-o-"}return false}(),_css_transform_scale:/(?:scale\()([0-9.]+)/,
_css_transform_scaleY:/(?:scale\([0-9.]+, )([0-9.]+)/,__useCSS3:false,__currentAnimation:null,__animationStep:function(a){var b,c,d,e;if(!this[0])return false;e=this[0].style;d=false;for(c in a)if(a.hasOwnProperty(c))if(b=a[c].pop()){e[c]=b;d=true}return d},__animationStepScale:function(a){var b,c,d,e,f;if(!this[0])return false;e=this._css_transform_preffix+"transform";f=this[0].style;d=false;for(c in a)if(a.hasOwnProperty(c))if(b=a[c].pop()){if(c.indexOf("scale")===0){b=c==="scaleX"?"scale("+b+", 1)":
c==="scaleY"?"scale(1, "+b+")":"scale("+b+")";(d=f[e].replace(/scale\(.*?\)/,b))||(d=b);f[e]=d}else f[c]=b;d=true}return d},__animationFunc:function(a,b,c){if(c(a))window.setTimeout(this.__currentAnimation,this.__animationInterval);else{b.onFinish&&b.onFinish(a);b&&b.triggerEvent&&b.triggerEvent("finish",this);this.__currentAnimation=null}},_animateMethod:function(a,b,c,d,e){switch(a){case "ease-in":a=2*(c-d)/(e*(e+1));for(c=1;c<e;c+=1)b.push(b[c-1]+c*a);break;case "ease-out":a=2*(c-d)/(e*(e+1));
for(c=1;c<e;c+=1)b.push(b[c-1]+(e-c)*a);break;default:a=(c-d)/e;for(c=1;c<e;c+=1)b.push(b[c-1]+a)}},_animateCSS3:function(a,b,c,d){var e=this._css_transition_preffix,f,g,j,i;g=f="";for(i in b)if(b.hasOwnProperty(i)){f=f+i+",";j=c[i]||c[0];g=g+j+","}this[0].style[e+"transition-property"]=f.substr(0,f.length-1);this[0].style[e+"transition-timing-function"]=g.substr(0,g.length-1);this[0].style[e+"transition-duration"]=a+"ms";this[0].style[e+"transition-delay"]="0";this.addEventListener("transitionend",
function(){this.__animationStep([[]],d);this[0].removeEventListener("transitionend",arguments.callee,false)}.bind(this));d.onStart&&d.onStart();window.setTimeout(function(h,l){var k,m;l&&l.triggerEvent&&l.triggerEvent("start",this);for(k in h)if(h.hasOwnProperty(k)){m=this.__propsUnits[k]||"";this[0].style[k]=h[k]+m}}.bind(this,b,d),1);return true},_animate:function(a,b,c,d){if(typeof c!=="Array"&&typeof c!=="Object")c=[c];if(!(this.__useCSS3&&this._animateCSS3(a,b,c,d))){var e,f,g,j,i,h;f={};a=a/
this.__animationInterval;if(isNaN(a)||a<=0)console.log("Frames is "+a+". Did you set time correctly?");this[1]||this._createCopy(b);h=false;for(g in b)if(b.hasOwnProperty(g)){f[g]=[];f[g].push(b[g]);switch(g){case "width":e=this.getWidth();break;case "height":e=this.getHeight();break;case "scaleY":h=true;e=this._css_transform_scaleY.exec(this[0].style[this._css_transform_preffix+"transform"]);if(e!==null){e=e[2];break}case "scale":case "scaleX":h=true;e=this._css_transform_scale.exec(this[0].style[this._css_transform_preffix+
"transform"]);e=e!==null?e[1]:this.__propsDefaultVals[g];break;default:e=this[0].style[g].replace("px","")||this.__propsDefaultVals[g]}e=bs.opt.number(e||0);if(e!==b[g]){e=[c[g]||c[0]||"linear",e,b[g],a];if(this.isUndefined(this.__static[e])){this._animateMethod(e[0],f[g],e[1],e[2],e[3]);this.__static[e]=f[g].slice(0)}else f[g]=this.__static[e].slice(0)}if(j=this.__propsUnits[g]||false){e=0;for(i=f[g].length;e<i;e+=1)f[g][e]+=j}}this.__currentAnimation=this.__animationFunc.bind(this,f,d,h&&this._css_transform_preffix!==
false?this.__animationStepScale:this.__animationStep);d.onStart&&d.onStart(f);d&&d.triggerEvent&&d.triggerEvent("start",this);this.__currentAnimation()}},_createCopy:function(a){var b,c,d,e;this[1]=this[0].cloneNode(true);d=this[0].style;e=this[1].style;c=window.getComputedStyle(this[0],null);e.display=e.display||"block";for(b in a)if(a[b]!==false&&c[b])d[b]=e[b]=c[b]},_hideShowStart:function(){var a=this[0].style;a.display="block";a.overflow="hidden";a.visibility="visible"},_showEnd:function(a){var b,
c=this[0].style,d=this[1].style;if(d.display!=="none")c.display=d.display;c.overflow=d.overflow;for(b in a)if(a.hasOwnProperty(b))c[b]=d[b]},_hideEnd:function(){this[0].style.display="none";this[0].style.visibility="hidden"},_hideShowParams:function(a){var b={height:true,width:true,opacity:true};if(!a||a.height){b.paddingTop=b.paddingBottom=true;b.marginTop=b.marginBottom=true;b.borderTopWidth=b.borderBottomWidth=true}if(!a||a.width){b.paddingLeft=b.paddingRight=true;b.marginLeft=b.marginRight=true;
b.borderLeftWidth=b.borderRightWidth=true}return bs.opt.mix(a,b)},show:function(a,b,c){if(this.isUndefined(a))a=this.__defaultTime;if(a<=0){this._showEnd();return this}b=this._hideShowParams(b);c=bs.opt.mix(c||{},{onStart:this._hideShowStart,onFinish:this._showEnd});var d,e;this[1]||this._createCopy(b);e=this[0].style;if(e.visibility==="hidden"||e.display==="none")for(d in b)if(b[d])e[d]=0;for(d in b)if(b.hasOwnProperty(d))if(b[d]===true)b[d]=this[1]&&this[1].style[d]?bs.opt.number(this[1].style[d].replace("px",
"")):this.__propsDefaultVals[d]||0;else delete b[d];this._animate(a,b,"ease-in",c);return this},hide:function(a,b,c){var d;if(this.isUndefined(a))a=this.__defaultTime;if(a<=0){this._hideEnd();return this}b=this._hideShowParams(b);c=bs.opt.mix(c||{},{onStart:this._hideShowStart,onFinish:this._hideEnd});for(d in b)if(b.hasOwnProperty(d))if(b[d]===true)b[d]=0;else b[d]===false&&delete b[d];this._animate(a,b,"ease-in",c);return this},_destroyEnd:function(){this[0]&&this[0].parentNode&&this[0].parentNode.removeChild(this[0]);
this[0]=null},destroy:function(a,b,c){b||(b={});c=bs.opt.mix(c||{},{onFinish:this._destroyEnd});return this.hide(a,b,c)},_fadeOutStart:function(){this[1]||this._createCopy()},fadeOut:function(a,b){b||(b={});if(a<=0)a=1;else if(this.isUndefined(a))a=this.__defaultTime;b.onStart=this._fadeOutStart;this._animate(a,{opacity:0},"ease-in",b);return this},_fadeInStart:function(){if(this[0].style.display==="none")this[0].style.display=this[1]&&this[1].style.display||"block";if(this[0].style.visibility===
"hidden")this[0].style.visibility="visible"},fadeIn:function(a,b){b||(b={});if(a<=0)a=1;else if(this.isUndefined(a))a=this.__defaultTime;b.onStart=this._fadeInStart;this._animate(a,{opacity:1},"ease-out",b);return this}},bs.DOMObject.prototype);bs.util.Observable=function(){this._listeners=[]};
bs.util.Observable.prototype=bs.Object.create({_listeners:[],addListener:function(a,b,c){if(!this._listeners[a]){console.log("New event: "+a);this._listeners[a]=[]}this.isUndefined(c)?this._listeners[a].push(b):this._listeners[a].push(c.bind(b))},triggerEvent:function(a,b){var c,d;if(this._listeners[a]){d=this._listeners[a];for(c in d)d.hasOwnProperty(c)&&d[c](b)}else console.log("No event listeners on: "+a)}});
bs.util.Notifier=function(a,b){this._elem=bs.$(a);this._msgStack=[];if(b)this._settings=bs.Object.create(b).merge(this._settings);this._bindFunctions()};
bs.util.Notifier.prototype=bs.Object.create({_elem:null,_settings:bs.Object.create({fadeTimeout:5E3,fadeTime:600,fadeInTime:200,append:false,animate:{width:false,height:true,opacity:true}}),_msgQueue:[],_hideMsg:function(){var a=this._msgQueue.shift();a&&a[0].destroy(this._settings.fadeTime,this._settings.animate)},_getTime:function(){return(new Date).getTime()},_push:function(a,b){var c,d,e;c=0;for(d=this._msgQueue.length;c<d;){e=bs.opt.posFloor((c+d)/2);if(this._msgQueue[e][1]<b)c=e+1;else if(this._msgQueue[e][1]>
b)d=e-1;else c=d=e}e=bs.opt.posFloor((c+d)/2);if(this._msgQueue[e]&&this._msgQueue[e][1]<b)e+=1;this._msgQueue.splice(e,0,[a,b])},_elementClicked:function(a){if(this.triggerEvent)return this.triggerEvent("click",a);else bs.$(a.currentTarget).destroy(this._settings.fadeTime,this._settings.animate);return false},_bindFunctions:function(){this._hideMsg=this._hideMsg.bind(this);this._elementClicked=this._elementClicked.bind(this)},_createNode:function(a,b){var c,d,e;c=bs.$(document.createElement("div"));
c.html(a);c.addClass("notifier-msg");d=bs.$(document.createElement("div"));if(!this.isUndefined(b)){e=bs.$(document.createElement("div"));e.html(b);e.addClass("notifier-title");d.append(e)}d.append(c);d.addEventListener("click",this._elementClicked,false);return d},_delayHideMsg:function(a){a>0&&window.setTimeout(this._hideMsg,a)},display:function(a,b,c){if(b<0||this.isUndefined(b))b=this._settings.fadeTimeout;var d=Math.floor(this._getTime()+b);a=this._createNode(a,c);this._push(a,d);a.hide(0);this._settings.append?
this._elem.append(a):this._elem.prepend(a);a.show(this._settings.fadeInTime,this._settings.animate);this._delayHideMsg(b)}}).merge(bs.util.Observable?bs.util.Observable.prototype:{});
